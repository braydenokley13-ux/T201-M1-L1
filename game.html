<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Knicks Cap Crash üèÄ</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="basketball-court">
        <div class="particles" id="particles"></div>

        <header class="game-header">
            <a href="index.html" class="back-link">‚Üê Back to Story</a>
            <h1 class="game-title">üèÄ KNICKS CAP CRASH üèÄ</h1>
            <p class="game-subtitle">Rebuild the championship roster under the $120M salary cap!</p>
        </header>

        <div class="scoreboard">
            <div class="stat-card">
                <div class="stat-label">Total Payroll</div>
                <div class="stat-value" id="totalPayroll">$0</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Cap Space</div>
                <div class="stat-value" id="capSpace">$120M</div>
            </div>
            <div class="stat-card highlight">
                <div class="stat-label">Quality Points</div>
                <div class="stat-value qpts" id="totalQPts">0</div>
                <div class="stat-subtext">Need 85+</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Players</div>
                <div class="stat-value" id="playerCount">0</div>
                <div class="position-display">
                    <span class="pos-badge pos-unmet" id="posG">G:0</span>
                    <span class="pos-badge pos-unmet" id="posF">F:0</span>
                    <span class="pos-badge pos-unmet" id="posC">C:0</span>
                </div>
            </div>
        </div>

        <div class="progress-container">
            <div class="progress-bar-wrapper">
                <label>Cap Usage</label>
                <div class="progress-bar">
                    <div class="progress-fill cap-fill" id="capProgress"></div>
                </div>
                <span id="capPercentage">0%</span>
            </div>
            <div class="progress-bar-wrapper">
                <label>Quality Points</label>
                <div class="progress-bar">
                    <div class="progress-fill qpts-fill" id="qptsProgress"></div>
                </div>
                <span id="qptsPercentage">0/85</span>
            </div>
        </div>

        <!-- Cap Breakdown Visual -->
        <div class="cap-breakdown-wrapper">
            <div class="cap-breakdown-label">Salary Breakdown</div>
            <div class="cap-breakdown" id="capBreakdown">
                <div class="breakdown-empty">Sign players to see cap breakdown</div>
            </div>
            <div class="cap-breakdown-legend">
                <span class="legend-item legend-star">‚≠ê Star</span>
                <span class="legend-item legend-rotation">üîµ Rotation</span>
                <span class="legend-item legend-vetmin">‚ö™ Vet Min</span>
            </div>
        </div>

        <div class="main-container">
            <div class="roster-grid" id="rosterGrid">
                <!-- Player cards will be generated here -->
            </div>

            <aside class="rules-sidebar">
                <h3>üìã Rule Checks</h3>
                <div class="rule-list" id="rulesList">
                    <div class="rule-item" id="ruleRoster">
                        <span class="rule-icon">‚è≥</span>
                        <span class="rule-text">Roster Size (10-13)</span>
                    </div>
                    <div class="rule-item" id="ruleCap">
                        <span class="rule-icon">‚è≥</span>
                        <span class="rule-text">Under Cap ($120M)</span>
                    </div>
                    <div class="rule-item" id="ruleStars">
                        <span class="rule-icon">‚è≥</span>
                        <span class="rule-text">Sign 2+ Stars</span>
                    </div>
                    <div class="rule-item" id="ruleQPts">
                        <span class="rule-icon">‚è≥</span>
                        <span class="rule-text">Quality Points ‚â• 85</span>
                    </div>
                    <div class="rule-item" id="rulePosition">
                        <span class="rule-icon">‚è≥</span>
                        <span class="rule-text">Lineup Balance (2G/2F/1C)</span>
                    </div>
                </div>

                <div class="info-box">
                    <h4>üí° Cap Exceptions</h4>
                    <p><strong>ü¶Ö Bird Rights:</strong> Players with ü¶Ö can be signed even over the cap!</p>
                    <p><strong>üí∞ MLE:</strong> Check to use on 1 player for 50% off salary</p>
                    <p><strong>üìâ Vet Min:</strong> Check to use on up to 3 players (&lt; 5 Q-Pts) for $2M each</p>
                    <p><strong>‚Üî Trade:</strong> Trade Knicks players ‚Äî you must receive a salary-matched return</p>
                </div>

                <button class="reset-btn" id="resetBtn">üîÑ Reset Game</button>
            </aside>
        </div>

        <div class="status-banner" id="statusBanner">
            <div class="status-content">
                <span id="statusIcon">‚è≥</span>
                <span id="statusText">Make your moves to build a winning roster!</span>
            </div>
        </div>
    </div>

    <!-- Success Modal -->
    <div class="modal" id="successModal">
        <div class="modal-content">
            <div class="confetti-container" id="confetti"></div>
            <h2>üéâ SEASON COMPLETE! üéâ</h2>

            <div class="season-results">
                <div class="tier-badge">
                    <div class="tier-icon">üèÜ</div>
                    <div class="tier-label">YOUR TIER</div>
                    <div class="tier-name" id="tierName">Championship</div>
                </div>

                <div class="season-stats">
                    <div class="stat-row">
                        <span class="stat-label">Regular Season:</span>
                        <span class="stat-value" id="seasonRecord">62-20</span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">Playoff Result:</span>
                        <span class="stat-value" id="playoffResult">NBA Champions!</span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">Total Quality:</span>
                        <span class="stat-value" id="finalQPts">0 pts</span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">Cap Efficiency:</span>
                        <span class="stat-value" id="capEfficiency">0%</span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">Season Luck:</span>
                        <span class="stat-value luck-value" id="luckRating">‚öñÔ∏è Average Luck</span>
                    </div>
                </div>

                <div class="tier-description" id="tierDescription">
                    Outstanding roster construction! Championship caliber team!
                </div>
            </div>

            <div class="claim-code">
                <label>üé´ Your Claim Code:</label>
                <div class="code-display" id="claimCode">CHAMPS2026</div>
            </div>

            <!-- Share Build -->
            <div class="share-build">
                <label>üîó Share Your Build:</label>
                <div class="share-row">
                    <input type="text" class="share-link-input" id="shareLink" readonly placeholder="Generating link..." />
                    <button class="copy-link-btn" id="copyLinkBtn" onclick="copyShareLink()">üìã Copy</button>
                </div>
            </div>

            <div class="modal-actions">
                <button class="modal-btn simulate-again-btn" id="simulateAgainBtn">üé≤ Simulate Again</button>
                <button class="modal-btn" id="closeModal">üîÑ Build Another Roster</button>
            </div>
        </div>
    </div>

    <!-- Trade Modal -->
    <div class="modal" id="tradeModal">
        <div class="modal-content trade-modal-content">
            <h2>‚Üî TRADE NEGOTIATION</h2>
            <div class="trade-sending">
                <div class="trade-sending-label">TRADING AWAY</div>
                <div class="trade-sending-player">
                    <span class="trade-player-name-big" id="tradeModalPlayerName">Player Name</span>
                    <span class="trade-player-salary-big" id="tradeModalSalary">$0M</span>
                </div>
                <div class="trade-match-rule">
                    Salary match limit: <strong id="tradeModalMaxReturn">$0M</strong> (125% rule)
                </div>
            </div>

            <div class="trade-returns-section">
                <h3 class="trade-section-title">‚úÖ Eligible Trade Returns</h3>
                <div class="trade-player-list" id="tradeEligibleList">
                    <!-- Populated by JS -->
                </div>

                <div class="trade-ineligible-section" id="tradeIneligibleSection">
                    <div class="trade-player-list" id="tradeIneligibleList">
                        <!-- Populated by JS -->
                    </div>
                </div>
            </div>

            <button class="cancel-trade-btn" onclick="cancelTrade()">‚úó Cancel Trade</button>
        </div>
    </div>

    <!-- Tutorial Overlay -->
    <div class="tutorial-overlay" id="tutorialOverlay">
        <div class="tutorial-tooltip" id="tutorialTooltip">
            <div class="tutorial-header">
                <span class="tutorial-badge">HOW TO PLAY</span>
                <span class="tutorial-counter" id="tutorialCounter">1 / 5</span>
            </div>
            <h3 class="tutorial-title" id="tutorialTitle">Welcome!</h3>
            <p class="tutorial-text" id="tutorialText">Let's walk through the basics.</p>
            <div class="tutorial-actions">
                <button class="tutorial-skip-btn" onclick="skipTutorial()">Skip</button>
                <button class="tutorial-next-btn" id="tutorialNext" onclick="nextTutorialStep()">Next ‚Üí</button>
            </div>
        </div>
    </div>

    <script src="players-data.js"></script>
    <script src="game.js"></script>
</body>
</html>
